/**
 * Path analysis module
 */
var path = require('path');
var fs = require('fs');

exports.analysis = function(req){
    var vhostName = harbors.config['server']['vhost']=='true' ? 'vhost:'+req.headers.host.split(':')[0] : 'server';
    var Con = '_.js';
    var Extname = path.extname(req.url);
    /\/$/.test(req.url) && (Con=path.sep+'index_.js');
    Extname == '' ?
        (
            req.url = path.join(harbors.config[vhostName].dir,req.url,harbors.config[vhostName].default_file),
            Extname = path.extname(harbors.config[vhostName].default_file)
        ) :
        (
            req.url = path.join(harbors.config[vhostName].dir,req.url)
        );
    var Dir = path.dirname(req.url);
    var File = path.basename(req.url);
    return {
        vhostName:vhostName,
        Dir:Dir,
        File:File,
        Extname:Extname,
        Con:Con
    };
};

exports.exists = function (file,yes,no){

    fs.exists(file,function(exists){
        exists ? yes() : no();
    });

};
